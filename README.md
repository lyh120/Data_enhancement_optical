# ðŸ“Š Data_enhancement_optical
Data_enhancement for optical network.
## å…³é”®æ–‡ä»¶è¯´æ˜Ž ðŸ”
ä¸‹é¢æ˜¯é¡¹ç›®é‡Œå…³é”®æ–‡ä»¶åŠå…¶ä½œç”¨çš„ä»‹ç»ï¼š

| æ–‡ä»¶å | è¯´æ˜Ž |
| --- | --- |
| `Conditional_VAE_with_GAN_V1.py` | åŒ…å«æ¡ä»¶å˜åˆ†è‡ªç¼–ç å™¨ï¼ˆCVAEï¼‰ä¸Žç”Ÿæˆå¯¹æŠ—ç½‘ç»œï¼ˆGANï¼‰ç»“åˆçš„å®žçŽ°ä»£ç ï¼Œç”¨äºŽå…‰å­¦ç½‘ç»œçš„æ•°æ®å¢žå¼ºã€‚ä»£ç ä¸­å®šä¹‰äº†æ¨¡åž‹ç»“æž„ã€è®­ç»ƒæµç¨‹ã€æŸå¤±è®¡ç®—ç­‰åŠŸèƒ½ã€‚ |
| `README.md` | å½“å‰æ–‡ä»¶ï¼Œä¸ºé¡¹ç›®æä¾›æ¦‚è¿°å’Œå…³é”®æ–‡ä»¶è¯´æ˜Žï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€Ÿäº†è§£é¡¹ç›®ã€‚ |
| `best_model.pth` | è®­ç»ƒè¿‡ç¨‹ä¸­ä¿å­˜çš„æœ€ä½³æ¨¡åž‹æƒé‡æ–‡ä»¶ï¼Œåœ¨ `Conditional_VAE_with_GAN_V1.py` é‡Œé€šè¿‡ `_check_improvement` æ–¹æ³•ä¿å­˜ã€‚ |

## æ¨¡åž‹è§£æž ðŸ¤–
### æ¨¡åž‹æ¦‚è¿° ðŸ“ˆ
ç»“åˆäº†æ¡ä»¶VAEå’ŒGANæŠ€æœ¯ï¼Œæ—¨åœ¨é€šè¿‡å­¦ä¹ è¾“å…¥ï¼ˆxï¼‰å’Œè¾“å‡ºï¼ˆyï¼‰ä¹‹é—´çš„å…³ç³»ï¼Œç”Ÿæˆæ–°çš„è¾“å…¥æ ·æœ¬ä»¥å¢žå¼ºæ•°æ®é›†ã€‚æ¨¡åž‹é¦–å…ˆé€šè¿‡MultiScaleFeatureExtractoræå–å¤šå°ºåº¦ç‰¹å¾ï¼Œç„¶åŽä½¿ç”¨æ¡ä»¶VAEç¼–ç å’Œè§£ç æ•°æ®ï¼ŒGANéƒ¨åˆ†é€šè¿‡ç”Ÿæˆå™¨å’Œåˆ¤åˆ«å™¨ç¡®ä¿ç”Ÿæˆæ ·æœ¬çš„çœŸå®žæ€§ï¼ŒMetaAugmentationControlleråŠ¨æ€è°ƒæ•´å¢žå¼ºå‚æ•°ã€‚

### æ¨¡åž‹ä¸»ä½“æž¶æž„ ðŸ—ï¸
CVAE-GAN æ¨¡åž‹ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š
1. **æ¡ä»¶å˜åˆ†è‡ªç¼–ç å™¨ï¼ˆCVAEï¼‰**ï¼šç”¨äºŽå­¦ä¹ è¾“å…¥æ•°æ®çš„æ½œåœ¨è¡¨ç¤ºã€‚å®ƒç”±ç¼–ç å™¨å’Œè§£ç å™¨ä¸¤éƒ¨åˆ†ç»„æˆï¼Œç¼–ç å™¨å°†è¾“å…¥æ•°æ®æ˜ å°„åˆ°æ½œåœ¨ç©ºé—´ï¼ˆéšç©ºé—´ï¼‰ï¼Œè§£ç å™¨åˆ™å°†æ½œåœ¨ç©ºé—´çš„ç‚¹æ˜ å°„å›žæ•°æ®ç©ºé—´ã€‚åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼ŒCVAE è¿˜é€šè¿‡æœ€å°åŒ–é‡æž„æŸå¤±å’Œ KL æ•£åº¦ï¼ˆç”¨äºŽæ­£åˆ™åŒ–ï¼‰æ¥å­¦ä¹ æ•°æ®çš„åˆ†å¸ƒã€‚
2. **ç”Ÿæˆå¯¹æŠ—ç½‘ç»œï¼ˆGANï¼‰**ï¼šç”¨äºŽç”Ÿæˆä¸Žè¾“å…¥æ•°æ®ç›¸ä¼¼çš„æ–°æ ·æœ¬ã€‚GAN ç”±ç”Ÿæˆå™¨å’Œåˆ¤åˆ«å™¨ä¸¤éƒ¨åˆ†ç»„æˆã€‚ç”Ÿæˆå™¨æŽ¥æ”¶éšæœºå™ªå£°ä½œä¸ºè¾“å…¥ï¼Œå¹¶å°è¯•ç”Ÿæˆä¸ŽçœŸå®žæ•°æ®åˆ†å¸ƒç›¸ä¼¼çš„æ ·æœ¬ã€‚åˆ¤åˆ«å™¨åˆ™æŽ¥æ”¶çœŸå®žæ ·æœ¬å’Œç”Ÿæˆå™¨ç”Ÿæˆçš„æ ·æœ¬ä½œä¸ºè¾“å…¥ï¼Œç›®æ ‡æ˜¯åŒºåˆ†çœŸå‡æ ·æœ¬ã€‚åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œç”Ÿæˆå™¨é€šè¿‡å¯¹æŠ—è®­ç»ƒæ¥å­¦ä¹ ç”Ÿæˆé€¼çœŸçš„æ ·æœ¬ï¼Œè€Œåˆ¤åˆ«å™¨åˆ™é€šè¿‡æœ€å°åŒ–äº¤å‰ç†µæŸå¤±æ¥æé«˜å…¶åˆ†ç±»èƒ½åŠ›ã€‚

### å„ç»„ä»¶åŠŸèƒ½æ¦‚è¦ ðŸ”
1. **æ¡ä»¶VAE** ç¼–ç è¾“å…¥xå¹¶åŸºäºŽè¾“å‡ºyç”Ÿæˆæ½œåœ¨ç©ºé—´è¡¨ç¤ºï¼Œé‡å»ºè¾“å…¥ä»¥å­¦ä¹ æ¡ä»¶åˆ†å¸ƒã€‚  
2. **ç”Ÿæˆå™¨**ä»Žå™ªå£°å’Œyç”Ÿæˆæ½œåœ¨å‘é‡ï¼Œè¯•å›¾æ¬ºéª—åˆ¤åˆ«å™¨ã€‚  
3. **åˆ¤åˆ«å™¨**åŒºåˆ†çœŸå®žæ½œåœ¨å‘é‡ï¼ˆæ¥è‡ªVAEï¼‰å’Œå‡çš„æ½œåœ¨å‘é‡ï¼ˆæ¥è‡ªç”Ÿæˆå™¨ï¼‰ã€‚  
4. **å…ƒå¢žå¼ºæŽ§åˆ¶å™¨**æ ¹æ®è¾“å…¥å’Œè¾“å‡ºå†³å®šå¢žå¼ºå‚æ•°ï¼Œå¦‚å™ªå£°æ°´å¹³å’Œæ··åˆæ¯”ä¾‹ã€‚
5. **SelfAttention**æä¾›æ³¨æ„åŠ›æœºåˆ¶ï¼Œå…è®¸æ¨¡åž‹å…³æ³¨è¾“å…¥çš„ä¸åŒéƒ¨åˆ†ã€‚  
6. **PhysicsInformedLayer**åŒ…å«ç‰©ç†ä¿¡æ¯ï¼Œç”¨äºŽæŒ‡å¯¼æ¨¡åž‹ç”Ÿæˆç¬¦åˆç‰©ç†çº¦æŸçš„æ ·æœ¬ã€‚  

### æ ¸å¿ƒç±»â€”â€”â€”â€”AdvancedVAEcGANç±»çš„å»ºç«‹ä¸Žæž¶æž„ ðŸ”
AdvancedVAEcGANç±»ï¼Œæ•´åˆäº†å¤šç§ç¥žç»ç½‘ç»œç»„ä»¶ï¼Œå½¢æˆä¸€ä¸ªæ¡ä»¶ç”Ÿæˆæ¨¡åž‹ã€‚æ¨¡åž‹å»ºç«‹è¿‡ç¨‹åŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š  é…ç½®ç®¡ç†ï¼šé€šè¿‡ConfigManagerç±»å®šä¹‰æ¨¡åž‹è¶…å‚æ•°ï¼Œå¦‚è¾“å…¥ç»´åº¦ï¼ˆ12ï¼‰ã€è¾“å‡ºç»´åº¦ï¼ˆ5ï¼‰ã€æ½œåœ¨ç©ºé—´ç»´åº¦ï¼ˆ10ï¼‰ç­‰ã€‚è¿™äº›å‚æ•°æŽ§åˆ¶æ¨¡åž‹çš„è§„æ¨¡å’Œè®­ç»ƒè¡Œä¸ºã€‚  
æ•°æ®é¢„å¤„ç†ï¼šDataPreprocessorç±»è´Ÿè´£åŠ è½½æ•°æ®ï¼ˆå¦‚lhs_dataset_5wave_500.npzï¼‰å¹¶è¿›è¡Œæ ‡å‡†åŒ–ï¼Œç¡®ä¿è¾“å…¥å’Œè¾“å‡ºæ•°æ®çš„åˆ†å¸ƒé€‚åˆè®­ç»ƒã€‚æ ‡å‡†åŒ–ä½¿ç”¨å‡å€¼å’Œæ ‡å‡†å·®ï¼Œé˜²æ­¢é™¤é›¶é—®é¢˜ã€‚  
æ¨¡åž‹åˆå§‹åŒ–ï¼šAdvancedVAEcGANç±»åˆå§‹åŒ–æ—¶ï¼Œæ•´åˆäº†MultiScaleFeatureExtractorã€ConditionalVAEã€AdvancedGeneratorã€SNDiscriminatorå’ŒMetaAugmentationControllerï¼Œå¹¶è®¾ç½®è‡ªå®šä¹‰æŸå¤±å‡½æ•°ï¼ˆå¦‚CustomVAELosså’ŒCustomGANLossï¼‰ã€‚

#### SelfAttention

- **åŠŸèƒ½**: å®žçŽ°è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼Œå…è®¸æ¨¡åž‹å…³æ³¨è¾“å…¥çš„ä¸åŒéƒ¨åˆ†ï¼Œæå‡ç‰¹å¾æå–èƒ½åŠ›ã€‚
- **å®žçŽ°**: é€šè¿‡æŸ¥è¯¢ï¼ˆqueryï¼‰ã€é”®ï¼ˆkeyï¼‰å’Œå€¼ï¼ˆvalueï¼‰è®¡ç®—æ³¨æ„åŠ›åˆ†æ•°ï¼Œä½¿ç”¨softmaxå½’ä¸€åŒ–åŽä¸Žå€¼è¿›è¡ŒçŸ©é˜µä¹˜æ³•ï¼Œè¾“å‡ºåŠ æƒåŽçš„ç‰¹å¾ã€‚å…¬å¼ä¸º:
  $\text{Attention}(Q, K, V) = \text{softmax}\left(\frac{QK^T}{\sqrt{d_k}}\right)V$

  å…¶ä¸­ $d_k$ ä¸ºé”®çš„ç»´åº¦ï¼Œè¾“å‡ºé€šè¿‡å¯å­¦ä¹ å‚æ•° $y$ ä¸ŽåŽŸå§‹è¾“å…¥ç›¸åŠ ã€‚

#### ConditionalBlock

- **åŠŸèƒ½**: å¤„ç†æ¡ä»¶è¾“å…¥ï¼Œç»“åˆæ¡ä»¶ä¿¡æ¯å¯¹ç‰¹å¾è¿›è¡Œç¼©æ”¾å’Œåç§»ã€‚
- **å®žçŽ°**: åŒ…å«çº¿æ€§å±‚ã€æ‰¹å½’ä¸€åŒ–ï¼ˆ`BatchNormId`ï¼‰å’Œ`LeakyReLU`æ¿€æ´»ï¼Œæ¡ä»¶ä¿¡æ¯é€šè¿‡`cond_gamma`å’Œ`cond_beta`åˆ†åˆ«æŽ§åˆ¶ç‰¹å¾çš„ç¼©æ”¾å’Œåç§»ã€‚

#### PhysicsInformedLayer  
- **åŠŸèƒ½**: å¼•å…¥ç‰©ç†çº¦æŸï¼Œæå‡æ¨¡åž‹å¯¹ç‰¹å®šé¢†åŸŸçŸ¥è¯†çš„é€‚åº”æ€§ã€‚  
- **å®žçŽ°**: åŸºäºŽæ¡ä»¶ `c` è®¡ç®—çº¦æŸé¡¹ï¼Œé€šè¿‡å¯å­¦ä¹ å‚æ•° `y` ä¸Žè¾“å…¥ç›¸åŠ ï¼Œç¡®ä¿æ¨¡åž‹è¾“å‡ºç¬¦åˆç‰©ç†è§„å¾‹ã€‚  

#### MultiScaleFeatureExtractor  
- **åŠŸèƒ½**: ä»Žè¾“å…¥ `x` å’Œè¾“å‡º `y` æå–å¤šå°ºåº¦ç‰¹å¾ï¼Œæå‡æ¨¡åž‹å¯¹å¤æ‚å…³ç³»çš„æ•æ‰èƒ½åŠ›ã€‚  
- **å®žçŽ°**: ä½¿ç”¨å¤šä¸ªåˆ†æ”¯ï¼ˆå¯¹åº”ä¸åŒå°ºåº¦ï¼Œå¦‚ `16`ã€`32`ã€`64`ï¼‰æå–ç‰¹å¾ï¼Œé€šè¿‡è‡ªé€‚åº”å¹³å‡æ± åŒ–ï¼ˆ`adaptive_avg_pool1d`ï¼‰è¿›è¡Œè·¨å°ºåº¦èžåˆï¼Œæœ€ç»ˆé€šè¿‡çº¿æ€§å±‚æ•´åˆç‰¹å¾ã€‚  

#### ConditionalVAE  
- **åŠŸèƒ½**: å®žçŽ°æ¡ä»¶å˜åˆ†è‡ªç¼–ç å™¨ï¼Œå­¦ä¹  `x` ç»™å®š `y` çš„æ¡ä»¶åˆ†å¸ƒã€‚  
- **å®žçŽ°**:  
  - **ç¼–ç å™¨**: é€šè¿‡ `MultiScaleFeatureExtractor` æå–ç‰¹å¾åŽï¼Œç»“åˆ `y` é€šè¿‡çº¿æ€§å±‚å’Œè‡ªæ³¨æ„åŠ›å±‚æ˜ å°„åˆ°æ½œåœ¨ç©ºé—´ï¼Œè¾“å‡ºå‡å€¼ $\mu$ å’Œå¯¹æ•°æ–¹å·® $\log \sigma^2$ã€‚  
  - **é‡å‚æ•°åŒ–**: ä½¿ç”¨ $\mu + \epsilon \cdot \exp(0.5 \cdot \log \sigma^2)$ é‡‡æ ·æ½œåœ¨å˜é‡ `z`ï¼Œå…¶ä¸­ $\epsilon \sim \mathcal{N}(0,1)$ã€‚  
  - **è§£ç å™¨**: ç»“åˆ `z` å’Œ `y` é€šè¿‡çº¿æ€§å±‚é‡å»º `x`ï¼Œä¸­é—´åŠ å…¥ `PhysicsInformedLayer` å¼•å…¥ç‰©ç†çº¦æŸã€‚  

  - **æŸå¤±å‡½æ•°**: åŒ…æ‹¬é‡å»ºæŸå¤±ï¼ˆMSEç­‰ï¼‰å’ŒKLæ•£åº¦ï¼Œå…¬å¼ä¸º:  
    $L_{\text{VAE}} = \text{Reconstruction Loss} + \beta \cdot \text{KL}\left(\mathcal{N}(\mu, \sigma^2) \parallel \mathcal{N}(0,1)\right)$
    å…¶ä¸­ $\beta = 0.7$ï¼ˆä»Žé…ç½®ä¸­èŽ·å–ï¼‰ã€‚

### AdvancedGenerator
- **åŠŸèƒ½**: ç”Ÿæˆæ¡ä»¶æ½œåœ¨å‘é‡ `z`ï¼Œè¯•å›¾æ¬ºéª—åˆ¤åˆ«å™¨ã€‚  
- **å®žçŽ°**: ä»Žå™ªå£°å’Œæ¡ä»¶ `y` å¼€å§‹ï¼Œé€šè¿‡å¤šä¸ª `ConditionalBlock` å’Œè‡ªæ³¨æ„åŠ›å±‚é€æ­¥ç”Ÿæˆ `z`ï¼Œæœ€ç»ˆé€šè¿‡ `Tanh` å’Œçº¿æ€§å±‚è¾“å‡ºã€‚  

### SNDiscriminator
- **åŠŸèƒ½**: åŒºåˆ†çœŸå®žæ½œåœ¨å‘é‡ï¼ˆæ¥è‡ªVAEï¼‰å’Œå‡çš„æ½œåœ¨å‘é‡ï¼ˆæ¥è‡ªç”Ÿæˆå™¨ï¼‰ã€‚  
- **å®žçŽ°**: ä½¿ç”¨è°±å½’ä¸€åŒ–ï¼ˆ`spectral normalization`ï¼‰ç¨³å®šè®­ç»ƒï¼Œé€šè¿‡çº¿æ€§å±‚å’Œè‡ªæ³¨æ„åŠ›å±‚å¤„ç† `z` å’Œ `y` çš„æ‹¼æŽ¥ï¼Œè¾“å‡ºä¸€ä¸ªæ ‡é‡è¡¨ç¤ºçœŸå®žæ¦‚çŽ‡ã€‚  
#### MetaAugmentationController  
- **åŠŸèƒ½**ï¼šåŠ¨æ€å†³å®šæ•°æ®å¢žå¼ºå‚æ•°ï¼Œå¦‚å™ªå£°æ°´å¹³ã€æ··åˆæ¯”ä¾‹å’Œç”Ÿæˆå› å­ã€‚  
- **å®žçŽ°**ï¼šé€šè¿‡çº¿æ€§å±‚å¤„ç†xå’Œyçš„æ‹¼æŽ¥ï¼Œè¾“å‡ºä¸‰ä¸ªå‚æ•°ï¼ˆå™ªå£°æ°´å¹³ã€æ··åˆæ¯”ä¾‹ã€ç”Ÿæˆå› å­ï¼‰ï¼Œé€šè¿‡sigmoidæ¿€æ´»é™åˆ¶åœ¨[0,1]èŒƒå›´å†…ï¼Œç”Ÿæˆå› å­è¿›ä¸€æ­¥çº¿æ€§å˜æ¢ã€‚


### ç»„ä»¶åä½œæœºåˆ¶ ðŸ”„
æ¨¡åž‹çš„è®­ç»ƒå’Œç”Ÿæˆè¿‡ç¨‹ä½“çŽ°äº†å„ç»„ä»¶çš„ååŒå·¥ä½œã€‚  
ç‰¹å¾æå–ä¸Žç¼–ç ï¼šMultiScaleFeatureExtractor é¦–å…ˆå¤„ç†è¾“å…¥ $x$ å’Œæ¡ä»¶ $y$ï¼Œæå–å¤šå°ºåº¦ç‰¹å¾ï¼Œç„¶åŽå°†å…¶è¾“å…¥åˆ° ConditionalVAE çš„ç¼–ç å™¨ä¸­ã€‚ç¼–ç å™¨ç»“åˆæ¡ä»¶ $y$ ç”Ÿæˆæ½œåœ¨ç©ºé—´çš„å‡å€¼ $\mu$ å’Œå¯¹æ•°æ–¹å·® $\log\sigma^2$ï¼Œé€šè¿‡é‡å‚æ•°åŒ–æŠ€å·§é‡‡æ ·å¾—åˆ°éšå˜é‡ $z$ã€‚

VAEè®­ç»ƒï¼šä½¿ç”¨CustomVAELossè®¡ç®—æŸå¤±ï¼ŒåŒ…æ‹¬é‡å»ºæŸå¤±å’ŒåŠ æƒçš„KLæ•£åº¦ã€‚æŸå¤±å‡½æ•°è¿˜åŒ…æ‹¬å‘¨æœŸæ€§KLå¢žå¼ºï¼ˆæ¯10ä¸ªepochå¢žåŠ ä¸€é¡¹ï¼‰ï¼Œæå‡æ½œåœ¨ç©ºé—´çš„åˆ†å¸ƒè´¨é‡ã€‚  
ä¼˜åŒ–å™¨ä¸ºAdamï¼Œå­¦ä¹ çŽ‡ä»Žé…ç½®ä¸­èŽ·å–ï¼ˆä¾‹å¦‚2e-4ï¼‰ï¼Œå¹¶ä½¿ç”¨æ¢¯åº¦è£å‰ªï¼ˆmax_norm=1.0ï¼‰é˜²æ­¢æ¢¯åº¦çˆ†ç‚¸ã€‚

GANè®­ç»ƒï¼šç”Ÿæˆå™¨ä»Žå™ªå£°å’Œyç”Ÿæˆå‡zï¼Œåˆ¤åˆ«å™¨åŒºåˆ†çœŸå®žzï¼ˆæ¥è‡ªVAEï¼‰å’Œå‡zã€‚  
æŸå¤±å‡½æ•°ä¸ºCustomGANLossï¼ŒåŸºäºŽäºŒåˆ†ç±»äº¤å‰ç†µï¼ˆBCEï¼‰ï¼ŒæŸå¤±å‡½æ•°ä¸º CustomGANLossï¼ŒåŸºäºŽäºŒåˆ†ç±»äº¤å‰ç†µï¼ˆBCEï¼‰ï¼Œå¹¶åŠ å…¥æ¢¯åº¦æƒ©ç½šï¼ˆWGAN - GP é£Žæ ¼ï¼‰ç¡®ä¿ Lipschitz è¿žç»­æ€§ã€‚å…¬å¼ä¸ºï¼š
$L _ { \mathrm { G P } } = E \Bigl [ ( \| \nabla _ { \hat { \mathbf { Z } } } D ( \hat { \mathbf { Z } } ) \| _ { 2 } - 1 ) ^ { 2 } \Bigr ]$
å…¶ä¸­ $\hat{z}$
ä¸ºçœŸå®žå’Œå‡æ ·æœ¬çš„æ’å€¼ã€‚  
ä¼˜åŒ–å™¨åˆ†åˆ«ä¸ºAdamï¼ˆç”Ÿæˆå™¨1e-4ï¼Œåˆ¤åˆ«å™¨4e-4ï¼‰ï¼ŒåŒæ ·ä½¿ç”¨æ¢¯åº¦è£å‰ªã€‚

å…ƒå¢žå¼ºæŽ§åˆ¶å™¨è®­ç»ƒï¼šæŽ§åˆ¶å™¨æ ¹æ®xå’Œyè¾“å‡ºå¢žå¼ºå‚æ•°ï¼Œç”Ÿæˆæ–°æ ·æœ¬å¹¶è®¡ç®—é‡å»ºæŸå¤±ï¼ˆMSEï¼‰ï¼Œä¼˜åŒ–æŽ§åˆ¶å™¨ä»¥æ”¹è¿›å¢žå¼ºæ•ˆæžœã€‚  
ä¼˜åŒ–å™¨ä¸ºRMSpropï¼Œå­¦ä¹ çŽ‡5e-4ï¼ŒåŒæ ·ä½¿ç”¨æ¢¯åº¦è£å‰ªã€‚

æ•°æ®å¢žå¼ºè¿‡ç¨‹ï¼šgenerate_samplesæ–¹æ³•ä»Žå™ªå£°é‡‡æ ·ï¼Œé€šè¿‡ç”Ÿæˆå™¨å’ŒVAEè§£ç å™¨ç”Ÿæˆæ–°æ ·æœ¬ï¼Œæ¡ä»¶ä¸ºyï¼Œå¯é€‰æ‹©ç­–ç•¥ï¼ˆå¦‚â€œoptimalâ€ä½¿ç”¨æŽ§åˆ¶å™¨å‚æ•°ï¼‰ã€‚  
adaptive_augmentationæ–¹æ³•æ ¹æ®ç›®æ ‡å¤§å°åŠ¨æ€ç”Ÿæˆæ ·æœ¬ï¼Œä½¿ç”¨æŽ§åˆ¶å™¨å‚æ•°æŽ§åˆ¶ç”Ÿæˆæ•°é‡å’Œè´¨é‡ï¼Œç¡®ä¿å¢žå¼ºåŽæ•°æ®é›†è¾¾åˆ°æŒ‡å®šè§„æ¨¡ã€‚

## æ¨¡åž‹è®­ç»ƒ ðŸš€
### è®­ç»ƒè¿‡ç¨‹ ðŸš€
CVAE-GAN æ¨¡åž‹çš„è®­ç»ƒåˆ†ä¸ºä¸¤é˜¶æ®µï¼š
1. **é¢„è®­ç»ƒé˜¶æ®µ**ï¼šåœ¨è¯¥é˜¶æ®µï¼Œä»…è®­ç»ƒ CVAE æ¨¡åž‹ï¼Œç›®æ ‡æ˜¯å­¦ä¹ æ•°æ®çš„åˆ†å¸ƒã€‚é€šè¿‡æœ€å°åŒ–é‡æž„æŸå¤±å’Œ KL æ•£åº¦æ¥ä¼˜åŒ–æ¨¡åž‹å‚æ•°ã€‚
2. **å¯¹æŠ—è®­ç»ƒé˜¶æ®µ**ï¼šåœ¨è¯¥é˜¶æ®µï¼ŒåŒæ—¶è®­ç»ƒ CVAE å’Œ GAN æ¨¡åž‹ã€‚é¦–å…ˆï¼Œå›ºå®š CVAE çš„å‚æ•°ï¼Œä»…è®­ç»ƒ GAN çš„ç”Ÿæˆå™¨å’Œåˆ¤åˆ«å™¨ã€‚ç”Ÿæˆå™¨çš„ç›®æ ‡æ˜¯ç”Ÿæˆé€¼çœŸçš„æ ·æœ¬ï¼Œåˆ¤åˆ«å™¨çš„ç›®æ ‡æ˜¯å°†çœŸå®žæ ·æœ¬å’Œç”Ÿæˆå™¨ç”Ÿæˆçš„æ ·æœ¬åŒºåˆ†å¼€ã€‚é€šè¿‡å¯¹æŠ—è®­ç»ƒï¼Œç”Ÿæˆå™¨ä¸æ–­æé«˜ç”Ÿæˆé€¼çœŸæ ·æœ¬çš„èƒ½åŠ›ï¼Œè€Œåˆ¤åˆ«å™¨åˆ™ä¸æ–­æé«˜è¯†åˆ«çœŸå‡æ ·æœ¬çš„èƒ½åŠ›ã€‚åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œé€šè¿‡æœ€å°åŒ–ç”Ÿæˆå™¨çš„å¯¹æŠ—æŸå¤±å’Œåˆ¤åˆ«å™¨çš„äº¤å‰ç†µæŸå¤±æ¥ä¼˜åŒ–æ¨¡åž‹å‚æ•°ã€‚

### è®­ç»ƒç›‘æŽ§ ðŸ“ˆ
ä½¿ç”¨ModelTrainerç±»ç®¡ç†è®­ç»ƒè¿‡ç¨‹ï¼ŒåŒ…æ‹¬ï¼š  
æ¯epochæ‰“ä¹±æ•°æ®ï¼ŒæŒ‰æ‰¹æ¬¡è®­ç»ƒï¼ˆæ‰¹å¤§å°ä¸º4ï¼‰ã€‚  
ç›‘æŽ§æŸå¤±ï¼ˆå¦‚VAEæŸå¤±ã€GANæŸå¤±ï¼‰ï¼Œæ¯10ä¸ªepochä¿å­˜æ£€æŸ¥ç‚¹ã€‚  
å®žçŽ°æ—©åœï¼ˆpatience=30ï¼‰ï¼ŒåŸºäºŽVAEå’Œåˆ¤åˆ«å™¨æŸå¤±çš„ç»„åˆåˆ¤æ–­æ”¹å–„ã€‚  
å¤„ç†NaN/Infæƒ…å†µï¼Œé€šè¿‡å‡åŠå­¦ä¹ çŽ‡åº”å¯¹ï¼Œé˜²æ­¢è®­ç»ƒå´©æºƒã€‚

### æ•°æ®é¢„å¤„ç† ðŸ§¹
DataPreprocessoråŠ è½½æ•°æ®ï¼ˆå¦‚Latin Hypercube Samplingæ•°æ®é›†ï¼‰ï¼Œæ ‡å‡†åŒ–è¾“å…¥å’Œè¾“å‡ºï¼Œä½¿ç”¨å‡å€¼å’Œæ ‡å‡†å·®ï¼Œé¿å…é™¤é›¶é—®é¢˜ã€‚  
å¢žå¼ºåŽæ•°æ®é€šè¿‡inverse_transformæ¢å¤åŽŸå§‹å°ºåº¦ï¼Œä¿å­˜ä¸º.pthæ–‡ä»¶ï¼ŒåŒ…æ‹¬æ ‡å‡†åŒ–å’ŒåŽŸå§‹å°ºåº¦çš„æ•°æ®ã€‚

## æ¨¡åž‹æ•´ä½“æµç¨‹å›¾
```mermaid
graph LR
    A[è¾“å…¥æ•°æ®] --> B[å¤šå°ºåº¦ç‰¹å¾æå–]
    C[æ¡ä»¶æ•°æ®] --> B
    B --> D[CVAEç¼–ç å™¨]
    D --> E[éšå˜é‡ç©ºé—´]
    E --> F[CVAEè§£ç å™¨]
    F --> G[é‡å»ºæ•°æ®]
    H[å™ªå£°] --> I[ç”Ÿæˆå™¨]
    C --> I
    I --> E
    J[åˆ¤åˆ«å™¨] --> K[è¯„ä¼°éšå˜é‡çœŸå®žæ€§]
    K --> L[åé¦ˆä¿¡å·]
    L --> I
    M[å…ƒæŽ§åˆ¶å™¨] --> N[è‡ªé€‚åº”å¢žå¼ºå‚æ•°]
    N --> H
    N --> I
    N --> O[æ•°æ®æ··åˆ]
    O --> C
    G --> P[è®­ç»ƒæ•°æ®æ± ]
    P --> A;
```


